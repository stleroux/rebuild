<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Category;
use App\Comment;
use App\Module;
use App\Permission;
use App\User;
use Auth;

use Modules\Posts\Entities\Post;
use Modules\Recipes\Entities\Recipe;

class SiteController extends Controller
{

##################################################################################################################
#  ██████╗ ██████╗ ███╗   ██╗███████╗████████╗██████╗ ██╗   ██╗ ██████╗████████╗
# ██╔════╝██╔═══██╗████╗  ██║██╔════╝╚══██╔══╝██╔══██╗██║   ██║██╔════╝╚══██╔══╝
# ██║     ██║   ██║██╔██╗ ██║███████╗   ██║   ██████╔╝██║   ██║██║        ██║   
# ██║     ██║   ██║██║╚██╗██║╚════██║   ██║   ██╔══██╗██║   ██║██║        ██║   
# ╚██████╗╚██████╔╝██║ ╚████║███████║   ██║   ██║  ██║╚██████╔╝╚██████╗   ██║   
#  ╚═════╝ ╚═════╝ ╚═╝  ╚═══╝╚══════╝   ╚═╝   ╚═╝  ╚═╝ ╚═════╝  ╚═════╝   ╚═╝   
##################################################################################################################
	public function __construct()
	{
		// $this->middleware('auth');
	}


##################################################################################################################
# ██╗  ██╗ ██████╗ ███╗   ███╗███████╗██████╗  █████╗  ██████╗ ███████╗
# ██║  ██║██╔═══██╗████╗ ████║██╔════╝██╔══██╗██╔══██╗██╔════╝ ██╔════╝
# ███████║██║   ██║██╔████╔██║█████╗  ██████╔╝███████║██║  ███╗█████╗  
# ██╔══██║██║   ██║██║╚██╔╝██║██╔══╝  ██╔═══╝ ██╔══██║██║   ██║██╔══╝  
# ██║  ██║╚██████╔╝██║ ╚═╝ ██║███████╗██║     ██║  ██║╚██████╔╝███████╗
# ╚═╝  ╚═╝ ╚═════╝ ╚═╝     ╚═╝╚══════╝╚═╝     ╚═╝  ╚═╝ ╚═════╝ ╚══════╝
##################################################################################################################
	public function homepage()
	{
		$posts = Post::published()->with('user')->orderBy('id','desc')->take(setting('homepage_blog_count'))->get();

		// $popularArticle = Article::published()->get()->sortByDesc('views')->take(1);
		$popularPosts = Post::published()->get()->sortByDesc('views')->take(setting('homepage_favorite_post_count'));
		// dd($popularPosts);
		$popularRecipes = Recipe::published()->get()->sortByDesc('views')->take(setting('homepage_favorite_recipe_count'));
		// dd($popularRecipes);
		// $popularWoodProject = WoodProject::get()->sortByDesc('views')->take(1);

		return view('homepage', compact('posts','popularPosts','popularRecipes'));
	}


##################################################################################################################
#  █████╗ ██████╗  ██████╗ ██╗   ██╗████████╗
# ██╔══██╗██╔══██╗██╔═══██╗██║   ██║╚══██╔══╝
# ███████║██████╔╝██║   ██║██║   ██║   ██║   
# ██╔══██║██╔══██╗██║   ██║██║   ██║   ██║   
# ██║  ██║██████╔╝╚██████╔╝╚██████╔╝   ██║   
# ╚═╝  ╚═╝╚═════╝  ╚═════╝  ╚═════╝    ╚═╝  
##################################################################################################################
	public function about()
	{
		return view('about');
	}


##################################################################################################################
#  ██████╗ ██████╗ ███╗   ██╗████████╗ █████╗  ██████╗████████╗
# ██╔════╝██╔═══██╗████╗  ██║╚══██╔══╝██╔══██╗██╔════╝╚══██╔══╝
# ██║     ██║   ██║██╔██╗ ██║   ██║   ███████║██║        ██║   
# ██║     ██║   ██║██║╚██╗██║   ██║   ██╔══██║██║        ██║   
# ╚██████╗╚██████╔╝██║ ╚████║   ██║   ██║  ██║╚██████╗   ██║   
#  ╚═════╝ ╚═════╝ ╚═╝  ╚═══╝   ╚═╝   ╚═╝  ╚═╝ ╚═════╝   ╚═╝   
##################################################################################################################
	public function contact()
	{
		return view('contact');
	}


##################################################################################################################
# ████████╗███████╗██████╗ ███╗   ███╗███████╗
# ╚══██╔══╝██╔════╝██╔══██╗████╗ ████║██╔════╝
#    ██║   █████╗  ██████╔╝██╔████╔██║███████╗
#    ██║   ██╔══╝  ██╔══██╗██║╚██╔╝██║╚════██║
#    ██║   ███████╗██║  ██║██║ ╚═╝ ██║███████║
#    ╚═╝   ╚══════╝╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝
##################################################################################################################
	public function terms()
	{
		return view('termsAndConditions');
	}


##################################################################################################################
# ██████╗ ██████╗ ██╗██╗   ██╗ █████╗  ██████╗██╗   ██╗
# ██╔══██╗██╔══██╗██║██║   ██║██╔══██╗██╔════╝╚██╗ ██╔╝
# ██████╔╝██████╔╝██║██║   ██║███████║██║      ╚████╔╝ 
# ██╔═══╝ ██╔══██╗██║╚██╗ ██╔╝██╔══██║██║       ╚██╔╝  
# ██║     ██║  ██║██║ ╚████╔╝ ██║  ██║╚██████╗   ██║   
# ╚═╝     ╚═╝  ╚═╝╚═╝  ╚═══╝  ╚═╝  ╚═╝ ╚═════╝   ╚═╝   
##################################################################################################################
	public function privacy()
	{
		return view('privacyPolicy');
	}


##################################################################################################################
# ████████╗███████╗███████╗████████╗
# ╚══██╔══╝██╔════╝██╔════╝╚══██╔══╝
#    ██║   █████╗  ███████╗   ██║   
#    ██║   ██╔══╝  ╚════██║   ██║   
#    ██║   ███████╗███████║   ██║   
#    ╚═╝   ╚══════╝╚══════╝   ╚═╝  
##################################################################################################################
	public function test()
	{
		$users = User::all();
		return view('test', compact('users'));
	}


// STATISTICS
	public function stats()
	{
		$categoryCount = Category::count();
		$commentCount = Comment::count();
		$componentCount = \Module::count();
		$moduleCount = Module::count();
		$permissionCount = Permission::count();
		$postCount = Post::count();
		$recipeCount = Recipe::count();
		$userCount = User::count();

		$comments = Comment::all();
		$modules = Module::all();

		return view('stats.index', compact(
			'categoryCount','commentCount','componentCount','moduleCount','permissionCount','postCount','recipeCount','userCount',
			'comments','modules'
		));
	}


	public function dashboard()
	{
		return view('dashboard');
	}
}
